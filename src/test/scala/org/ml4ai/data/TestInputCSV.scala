package org.ml4ai.data
import java.io.InputStream
import java.util.zip.GZIPInputStream

import org.ml4ai.data.utils.InputRow
import org.scalatest._

import scala.io.Source

class TestInputCSV extends FlatSpec with Matchers{

  import TestInputCSV._


  "The CSV file with features" should "be readable as a resource" in {
    val stream = getStream
    stream should not be null
  }

  it should "be gzip compressed" in {
    noException should be thrownBy getGzipedStream
  }

  "The CSV's contents" should "contain the correct amount of lines" in {
    val lines = getLines
    lines should have size 230637 // This is the number of lines by wc -l
  }

  it should "contain the headers first" in {
    val lines = getLines
    val first = lines.next()
    first should be (headerText)
  }

  it should "be parseable" in {
    val stream = TestInputCSV.getGzipedStream
    val data = InputRow.fromStream(stream)
    data should have size (230637 - 1) // -1 is to account for the headers
  }

}

object TestInputCSV {
  val resourcePath = "/src/main/features/features.csv.gz"

  def getStream: InputStream = getClass.getResourceAsStream(resourcePath)
  def getGzipedStream = new GZIPInputStream(getStream)
  def getLines: Iterator[String] = Source.fromInputStream(getGzipedStream).getLines

  val headerText = """,PMCID,label,EvtID,CtxID,closesCtxOfClass,context_frequency,ctxDepTail_acomp_acomp,ctxDepTail_acomp_dep,ctxDepTail_acomp_prep,ctxDepTail_advcl_acomp,ctxDepTail_advcl_advcl,ctxDepTail_advcl_aux,ctxDepTail_advcl_auxpass,ctxDepTail_advcl_ccomp,ctxDepTail_advcl_conj,ctxDepTail_advcl_cop,ctxDepTail_advcl_dep,ctxDepTail_advcl_mark,ctxDepTail_advcl_mod,ctxDepTail_advcl_neg,ctxDepTail_advcl_obj,ctxDepTail_advcl_prep,ctxDepTail_advcl_subj,ctxDepTail_advcl_xcomp,ctxDepTail_agent_agent,ctxDepTail_agent_aux,ctxDepTail_agent_auxpass,ctxDepTail_agent_ccomp,ctxDepTail_agent_conj,ctxDepTail_agent_dep,ctxDepTail_agent_det,ctxDepTail_agent_mark,ctxDepTail_agent_mod,ctxDepTail_agent_neg,ctxDepTail_agent_prep,ctxDepTail_agent_subj,ctxDepTail_appos,ctxDepTail_appos_appos,ctxDepTail_appos_conj,ctxDepTail_appos_dep,ctxDepTail_appos_det,ctxDepTail_appos_mod,ctxDepTail_appos_nn,ctxDepTail_appos_num,ctxDepTail_appos_obj,ctxDepTail_appos_prep,ctxDepTail_appos_subj,ctxDepTail_aux,ctxDepTail_aux_advcl,ctxDepTail_aux_agent,ctxDepTail_aux_aux,ctxDepTail_aux_auxpass,ctxDepTail_aux_ccomp,ctxDepTail_aux_conj,ctxDepTail_aux_cop,ctxDepTail_aux_dep,ctxDepTail_aux_mark,ctxDepTail_aux_mod,ctxDepTail_aux_neg,ctxDepTail_aux_obj,ctxDepTail_aux_parataxis,ctxDepTail_aux_prep,ctxDepTail_aux_subj,ctxDepTail_aux_xcomp,ctxDepTail_auxpass_advcl,ctxDepTail_auxpass_agent,ctxDepTail_auxpass_auxpass,ctxDepTail_auxpass_ccomp,ctxDepTail_auxpass_conj,ctxDepTail_auxpass_dep,ctxDepTail_auxpass_mark,ctxDepTail_auxpass_mod,ctxDepTail_auxpass_neg,ctxDepTail_auxpass_obj,ctxDepTail_auxpass_parataxis,ctxDepTail_auxpass_prep,ctxDepTail_auxpass_prt,ctxDepTail_auxpass_subj,ctxDepTail_auxpass_xcomp,ctxDepTail_cc_cc,ctxDepTail_cc_dep,ctxDepTail_cc_det,ctxDepTail_ccomp_advcl,ctxDepTail_ccomp_aux,ctxDepTail_ccomp_auxpass,ctxDepTail_ccomp_cc,ctxDepTail_ccomp_ccomp,ctxDepTail_ccomp_conj,ctxDepTail_ccomp_cop,ctxDepTail_ccomp_dep,ctxDepTail_ccomp_det,ctxDepTail_ccomp_mark,ctxDepTail_ccomp_mod,ctxDepTail_ccomp_nn,ctxDepTail_ccomp_obj,ctxDepTail_ccomp_parataxis,ctxDepTail_ccomp_prep,ctxDepTail_ccomp_subj,ctxDepTail_ccomp_xcomp,ctxDepTail_conj,ctxDepTail_conj_advcl,ctxDepTail_conj_agent,ctxDepTail_conj_appos,ctxDepTail_conj_aux,ctxDepTail_conj_auxpass,ctxDepTail_conj_ccomp,ctxDepTail_conj_conj,ctxDepTail_conj_cop,ctxDepTail_conj_dep,ctxDepTail_conj_det,ctxDepTail_conj_mod,ctxDepTail_conj_nn,ctxDepTail_conj_num,ctxDepTail_conj_obj,ctxDepTail_conj_preconj,ctxDepTail_conj_prep,ctxDepTail_conj_punct,ctxDepTail_conj_subj,ctxDepTail_conj_xcomp,ctxDepTail_cop,ctxDepTail_cop_acomp,ctxDepTail_cop_advcl,ctxDepTail_cop_ccomp,ctxDepTail_cop_conj,ctxDepTail_cop_cop,ctxDepTail_cop_dep,ctxDepTail_cop_det,ctxDepTail_cop_mark,ctxDepTail_cop_mod,ctxDepTail_cop_neg,ctxDepTail_cop_nn,ctxDepTail_cop_num,ctxDepTail_cop_obj,ctxDepTail_cop_pcomp,ctxDepTail_cop_prep,ctxDepTail_cop_subj,ctxDepTail_cop_xcomp,ctxDepTail_dep,ctxDepTail_dep_appos,ctxDepTail_dep_aux,ctxDepTail_dep_auxpass,ctxDepTail_dep_cc,ctxDepTail_dep_ccomp,ctxDepTail_dep_conj,ctxDepTail_dep_cop,ctxDepTail_dep_dep,ctxDepTail_dep_det,ctxDepTail_dep_mark,ctxDepTail_dep_mod,ctxDepTail_dep_neg,ctxDepTail_dep_nn,ctxDepTail_dep_num,ctxDepTail_dep_number,ctxDepTail_dep_obj,ctxDepTail_dep_parataxis,ctxDepTail_dep_preconj,ctxDepTail_dep_prep,ctxDepTail_dep_subj,ctxDepTail_dep_xcomp,ctxDepTail_det,ctxDepTail_det_det,ctxDepTail_det_mod,ctxDepTail_det_nn,ctxDepTail_det_subj,ctxDepTail_mark,ctxDepTail_mark_advcl,ctxDepTail_mark_conj,ctxDepTail_mark_mark,ctxDepTail_mark_mod,ctxDepTail_mark_obj,ctxDepTail_mark_subj,ctxDepTail_mod,ctxDepTail_mod_advcl,ctxDepTail_mod_agent,ctxDepTail_mod_appos,ctxDepTail_mod_aux,ctxDepTail_mod_auxpass,ctxDepTail_mod_ccomp,ctxDepTail_mod_conj,ctxDepTail_mod_cop,ctxDepTail_mod_dep,ctxDepTail_mod_det,ctxDepTail_mod_mark,ctxDepTail_mod_mod,ctxDepTail_mod_neg,ctxDepTail_mod_nn,ctxDepTail_mod_num,ctxDepTail_mod_number,ctxDepTail_mod_obj,ctxDepTail_mod_poss,ctxDepTail_mod_prep,ctxDepTail_mod_prt,ctxDepTail_mod_subj,ctxDepTail_mod_xcomp,ctxDepTail_neg_neg,ctxDepTail_nn,ctxDepTail_nn_agent,ctxDepTail_nn_appos,ctxDepTail_nn_aux,ctxDepTail_nn_ccomp,ctxDepTail_nn_conj,ctxDepTail_nn_cop,ctxDepTail_nn_dep,ctxDepTail_nn_det,ctxDepTail_nn_mod,ctxDepTail_nn_nn,ctxDepTail_nn_num,ctxDepTail_nn_obj,ctxDepTail_nn_parataxis,ctxDepTail_nn_poss,ctxDepTail_nn_preconj,ctxDepTail_nn_prep,ctxDepTail_nn_punct,ctxDepTail_nn_subj,ctxDepTail_nn_xcomp,ctxDepTail_num,ctxDepTail_num_appos,ctxDepTail_num_dep,ctxDepTail_num_det,ctxDepTail_num_mod,ctxDepTail_num_nn,ctxDepTail_num_num,ctxDepTail_num_number,ctxDepTail_num_obj,ctxDepTail_num_prep,ctxDepTail_num_subj,ctxDepTail_obj,ctxDepTail_obj_advcl,ctxDepTail_obj_agent,ctxDepTail_obj_appos,ctxDepTail_obj_aux,ctxDepTail_obj_auxpass,ctxDepTail_obj_ccomp,ctxDepTail_obj_conj,ctxDepTail_obj_cop,ctxDepTail_obj_dep,ctxDepTail_obj_det,ctxDepTail_obj_mark,ctxDepTail_obj_mod,ctxDepTail_obj_neg,ctxDepTail_obj_nn,ctxDepTail_obj_num,ctxDepTail_obj_obj,ctxDepTail_obj_parataxis,ctxDepTail_obj_pcomp,ctxDepTail_obj_preconj,ctxDepTail_obj_prep,ctxDepTail_obj_subj,ctxDepTail_obj_xcomp,ctxDepTail_parataxis_dep,ctxDepTail_parataxis_mark,ctxDepTail_parataxis_mod,ctxDepTail_parataxis_nn,ctxDepTail_parataxis_parataxis,ctxDepTail_parataxis_prep,ctxDepTail_parataxis_subj,ctxDepTail_poss,ctxDepTail_poss_poss,ctxDepTail_poss_prep,ctxDepTail_preconj,ctxDepTail_preconj_neg,ctxDepTail_preconj_preconj,ctxDepTail_prep,ctxDepTail_prep_acomp,ctxDepTail_prep_advcl,ctxDepTail_prep_agent,ctxDepTail_prep_appos,ctxDepTail_prep_aux,ctxDepTail_prep_auxpass,ctxDepTail_prep_ccomp,ctxDepTail_prep_conj,ctxDepTail_prep_cop,ctxDepTail_prep_dep,ctxDepTail_prep_det,ctxDepTail_prep_mark,ctxDepTail_prep_mod,ctxDepTail_prep_neg,ctxDepTail_prep_nn,ctxDepTail_prep_num,ctxDepTail_prep_obj,ctxDepTail_prep_parataxis,ctxDepTail_prep_pcomp,ctxDepTail_prep_poss,ctxDepTail_prep_prep,ctxDepTail_prep_prt,ctxDepTail_prep_subj,ctxDepTail_prep_xcomp,ctxDepTail_prt_prt,ctxDepTail_punct,ctxDepTail_subj,ctxDepTail_subj_advcl,ctxDepTail_subj_agent,ctxDepTail_subj_appos,ctxDepTail_subj_aux,ctxDepTail_subj_auxpass,ctxDepTail_subj_ccomp,ctxDepTail_subj_conj,ctxDepTail_subj_cop,ctxDepTail_subj_dep,ctxDepTail_subj_det,ctxDepTail_subj_expl,ctxDepTail_subj_mark,ctxDepTail_subj_mod,ctxDepTail_subj_neg,ctxDepTail_subj_nn,ctxDepTail_subj_num,ctxDepTail_subj_obj,ctxDepTail_subj_parataxis,ctxDepTail_subj_preconj,ctxDepTail_subj_prep,ctxDepTail_subj_prt,ctxDepTail_subj_punct,ctxDepTail_subj_subj,ctxDepTail_subj_xcomp,ctxDepTail_xcomp_advcl,ctxDepTail_xcomp_appos,ctxDepTail_xcomp_aux,ctxDepTail_xcomp_auxpass,ctxDepTail_xcomp_ccomp,ctxDepTail_xcomp_conj,ctxDepTail_xcomp_dep,ctxDepTail_xcomp_mod,ctxDepTail_xcomp_nn,ctxDepTail_xcomp_obj,ctxDepTail_xcomp_prep,ctxDepTail_xcomp_subj,ctxDepTail_xcomp_xcomp,ctxNegationIntTail,ctxSentenceFirstPerson,ctxSentencePastTense,ctxSentencePresentTense,dependencyDistance,evtDepTail_advcl_advcl,evtDepTail_advcl_agent,evtDepTail_advcl_aux,evtDepTail_advcl_auxpass,evtDepTail_advcl_ccomp,evtDepTail_advcl_conj,evtDepTail_advcl_cop,evtDepTail_advcl_dep,evtDepTail_advcl_mark,evtDepTail_advcl_mod,evtDepTail_advcl_neg,evtDepTail_advcl_obj,evtDepTail_advcl_prep,evtDepTail_advcl_prt,evtDepTail_advcl_subj,evtDepTail_agent_agent,evtDepTail_agent_auxpass,evtDepTail_agent_ccomp,evtDepTail_agent_conj,evtDepTail_agent_dep,evtDepTail_agent_det,evtDepTail_agent_mark,evtDepTail_agent_mod,evtDepTail_agent_neg,evtDepTail_agent_nn,evtDepTail_agent_obj,evtDepTail_agent_prep,evtDepTail_agent_subj,evtDepTail_appos,evtDepTail_appos_appos,evtDepTail_appos_ccomp,evtDepTail_appos_conj,evtDepTail_appos_cop,evtDepTail_appos_dep,evtDepTail_appos_det,evtDepTail_appos_mark,evtDepTail_appos_mod,evtDepTail_appos_nn,evtDepTail_appos_num,evtDepTail_appos_obj,evtDepTail_appos_poss,evtDepTail_appos_prep,evtDepTail_appos_subj,evtDepTail_aux,evtDepTail_auxpass,evtDepTail_ccomp_advcl,evtDepTail_ccomp_aux,evtDepTail_ccomp_auxpass,evtDepTail_ccomp_ccomp,evtDepTail_ccomp_det,evtDepTail_ccomp_mark,evtDepTail_ccomp_mod,evtDepTail_ccomp_nn,evtDepTail_ccomp_obj,evtDepTail_ccomp_prep,evtDepTail_ccomp_subj,evtDepTail_conj,evtDepTail_conj_advcl,evtDepTail_conj_agent,evtDepTail_conj_appos,evtDepTail_conj_auxpass,evtDepTail_conj_ccomp,evtDepTail_conj_conj,evtDepTail_conj_cop,evtDepTail_conj_dep,evtDepTail_conj_det,evtDepTail_conj_mod,evtDepTail_conj_nn,evtDepTail_conj_num,evtDepTail_conj_obj,evtDepTail_conj_poss,evtDepTail_conj_preconj,evtDepTail_conj_prep,evtDepTail_conj_subj,evtDepTail_conj_xcomp,evtDepTail_dep,evtDepTail_dep_advcl,evtDepTail_dep_agent,evtDepTail_dep_appos,evtDepTail_dep_aux,evtDepTail_dep_auxpass,evtDepTail_dep_cc,evtDepTail_dep_conj,evtDepTail_dep_cop,evtDepTail_dep_dep,evtDepTail_dep_det,evtDepTail_dep_mark,evtDepTail_dep_mod,evtDepTail_dep_neg,evtDepTail_dep_nn,evtDepTail_dep_num,evtDepTail_dep_obj,evtDepTail_dep_preconj,evtDepTail_dep_prep,evtDepTail_dep_subj,evtDepTail_det,evtDepTail_det_det,evtDepTail_mark,evtDepTail_mark_mark,evtDepTail_mod,evtDepTail_mod_advcl,evtDepTail_mod_agent,evtDepTail_mod_appos,evtDepTail_mod_aux,evtDepTail_mod_auxpass,evtDepTail_mod_ccomp,evtDepTail_mod_conj,evtDepTail_mod_cop,evtDepTail_mod_dep,evtDepTail_mod_det,evtDepTail_mod_mark,evtDepTail_mod_mod,evtDepTail_mod_nn,evtDepTail_mod_number,evtDepTail_mod_obj,evtDepTail_mod_poss,evtDepTail_mod_prep,evtDepTail_mod_subj,evtDepTail_mod_xcomp,evtDepTail_neg,evtDepTail_nn,evtDepTail_nn_agent,evtDepTail_nn_appos,evtDepTail_nn_conj,evtDepTail_nn_dep,evtDepTail_nn_det,evtDepTail_nn_mod,evtDepTail_nn_nn,evtDepTail_nn_num,evtDepTail_nn_obj,evtDepTail_nn_prep,evtDepTail_nn_subj,evtDepTail_nn_xcomp,evtDepTail_num,evtDepTail_num_conj,evtDepTail_num_num,evtDepTail_num_prep,evtDepTail_number_dep,evtDepTail_number_number,evtDepTail_obj,evtDepTail_obj_acomp,evtDepTail_obj_advcl,evtDepTail_obj_agent,evtDepTail_obj_appos,evtDepTail_obj_aux,evtDepTail_obj_cc,evtDepTail_obj_ccomp,evtDepTail_obj_conj,evtDepTail_obj_dep,evtDepTail_obj_det,evtDepTail_obj_mark,evtDepTail_obj_mod,evtDepTail_obj_neg,evtDepTail_obj_nn,evtDepTail_obj_num,evtDepTail_obj_obj,evtDepTail_obj_preconj,evtDepTail_obj_prep,evtDepTail_obj_prt,evtDepTail_obj_subj,evtDepTail_obj_xcomp,evtDepTail_parataxis_aux,evtDepTail_parataxis_auxpass,evtDepTail_parataxis_ccomp,evtDepTail_parataxis_mark,evtDepTail_parataxis_prep,evtDepTail_parataxis_subj,evtDepTail_poss_conj,evtDepTail_poss_mod,evtDepTail_poss_nn,evtDepTail_poss_obj,evtDepTail_poss_poss,evtDepTail_poss_subj,evtDepTail_preconj,evtDepTail_preconj_conj,evtDepTail_preconj_mod,evtDepTail_preconj_nn,evtDepTail_preconj_preconj,evtDepTail_preconj_prep,evtDepTail_prep,evtDepTail_prep_acomp,evtDepTail_prep_advcl,evtDepTail_prep_agent,evtDepTail_prep_appos,evtDepTail_prep_aux,evtDepTail_prep_auxpass,evtDepTail_prep_ccomp,evtDepTail_prep_conj,evtDepTail_prep_cop,evtDepTail_prep_dep,evtDepTail_prep_det,evtDepTail_prep_expl,evtDepTail_prep_mark,evtDepTail_prep_mod,evtDepTail_prep_neg,evtDepTail_prep_nn,evtDepTail_prep_num,evtDepTail_prep_obj,evtDepTail_prep_parataxis,evtDepTail_prep_poss,evtDepTail_prep_preconj,evtDepTail_prep_predet,evtDepTail_prep_prep,evtDepTail_prep_subj,evtDepTail_prep_xcomp,evtDepTail_subj,evtDepTail_subj_acomp,evtDepTail_subj_advcl,evtDepTail_subj_agent,evtDepTail_subj_appos,evtDepTail_subj_aux,evtDepTail_subj_auxpass,evtDepTail_subj_cc,evtDepTail_subj_ccomp,evtDepTail_subj_conj,evtDepTail_subj_cop,evtDepTail_subj_dep,evtDepTail_subj_det,evtDepTail_subj_expl,evtDepTail_subj_mark,evtDepTail_subj_mod,evtDepTail_subj_neg,evtDepTail_subj_nn,evtDepTail_subj_num,evtDepTail_subj_obj,evtDepTail_subj_parataxis,evtDepTail_subj_preconj,evtDepTail_subj_prep,evtDepTail_subj_prt,evtDepTail_subj_subj,evtDepTail_subj_xcomp,evtDepTail_xcomp,evtDepTail_xcomp_advcl,evtDepTail_xcomp_aux,evtDepTail_xcomp_auxpass,evtDepTail_xcomp_ccomp,evtDepTail_xcomp_conj,evtDepTail_xcomp_cop,evtDepTail_xcomp_mark,evtDepTail_xcomp_mod,evtDepTail_xcomp_nn,evtDepTail_xcomp_num,evtDepTail_xcomp_obj,evtDepTail_xcomp_subj,evtDepTail_xcomp_xcomp,evtNegationInTail,evtSentenceFirstPerson,evtSentencePastTense,evtSentencePresentTense,sentenceDistance"""

}